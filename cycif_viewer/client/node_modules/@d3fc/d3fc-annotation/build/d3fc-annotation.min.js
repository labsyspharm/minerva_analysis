(function(a,b){"object"==typeof exports&&"undefined"!=typeof module?b(exports,require("d3-scale"),require("d3-selection"),require("@d3fc/d3fc-data-join"),require("@d3fc/d3fc-shape"),require("@d3fc/d3fc-rebind"),require("@d3fc/d3fc-series"),require("d3-shape")):"function"==typeof define&&define.amd?define(["exports","d3-scale","d3-selection","@d3fc/d3fc-data-join","@d3fc/d3fc-shape","@d3fc/d3fc-rebind","@d3fc/d3fc-series","d3-shape"],b):(a="undefined"==typeof globalThis?a||self:globalThis,b(a.fc=a.fc||{},a.d3,a.d3,a.fc,a.fc,a.fc,a.fc,a.d3))})(this,function(a,b,c,d,e,f,g,h){'use strict';function i(a){return j(a)||k(a)||l(a)||n()}function j(a){if(Array.isArray(a))return m(a)}function k(a){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(a))return Array.from(a)}function l(a,b){if(a){if("string"==typeof a)return m(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);return"Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c?Array.from(a):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?m(a,b):void 0}}function m(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=Array(b);c<b;c++)d[c]=a[c];return d}function n(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o=function(a){return"function"==typeof a?a:function(){return a}},p=function(){var a=b.scaleIdentity(),e=b.scaleIdentity(),f=function(a){return a},h=f,i=function(){},j="horizontal",k=d.dataJoin("g","annotation-line"),l=function(b){if(d.isTransition(b)&&k.transition(b),"horizontal"!==j&&"vertical"!==j)throw new Error("Invalid orientation");var g="horizontal"===j,l=g?function(c,a){return"translate(".concat(c,", ").concat(a,")")}:function(c,a){return"translate(".concat(a,", ").concat(c,")")},m=g?"x2":"y2",n=g?a:e,o=g?e:a,p=g?"left-handle":"bottom-handle",q=g?"right-handle":"top-handle",r=g?"9":"0",s=g?"0":"9",t=g?"0.32em":"0.71em",u=g?"start":"middle",v=n.range(),w=function(){return l(v[0],o(f.apply(void 0,arguments)))},x=v[1]-v[0];b.each(function(a,b,d){var e=k(c.select(d[b]),a),f=e.enter().attr("transform",w).style("stroke","#bbb");f.append("line").attr(m,x),f.append("g").classed(p,!0).style("stroke","none"),f.append("g").classed(q,!0).style("stroke","none").attr("transform",l(x,0)).append("text").attr("text-anchor",u).attr("x",r).attr("y",s).attr("dy",t),e.attr("class","annotation-line ".concat(j)),e.attr("transform",w),e.select("line").attr(m,x),e.select("g."+q).attr("transform",l(x,0)),e.select("text").text(h),i(e,a,b)})};return l.xScale=function(){return arguments.length?(a=0>=arguments.length?void 0:arguments[0],l):a},l.yScale=function(){return arguments.length?(e=0>=arguments.length?void 0:arguments[0],l):e},l.value=function(){return arguments.length?(f=o(0>=arguments.length?void 0:arguments[0]),l):f},l.label=function(){return arguments.length?(h=o(0>=arguments.length?void 0:arguments[0]),l):h},l.decorate=function(){return arguments.length?(i=0>=arguments.length?void 0:arguments[0],l):i},l.orient=function(){return arguments.length?(j=0>=arguments.length?void 0:arguments[0],l):j},l},q=function(){var a=b.scaleIdentity(),c=b.scaleIdentity(),e=function(a){return a},g=e,j=function(){},k="horizontal",l=h.line(),m=function(b){if("horizontal"!==k&&"vertical"!==k)throw new Error("Invalid orientation");var f="horizontal"===k,h=l.context(),m=f?a:c,n=f?c:a,o=m.domain(),p=f?9:0,q=f?0:9,r=f?"left":"center",s=f?"middle":"hanging";b.forEach(function(a,b){h.save(),h.beginPath(),h.strokeStyle="#bbb",h.fillStyle="#000",h.textAlign=r,h.textBaseline=s,j(h,a,b),l.context(h)(o.map(function(b){var c=[m(b),n(e(a))];return f?c:c.reverse()}));var c=f?m(o[1]):n(e(a)),d=f?n(e(a)):m(o[1]);h.fillText(g(a),c+p,d+q),h.fill(),h.stroke(),h.closePath(),h.restore()})};return m.xScale=function(){return arguments.length?(a=0>=arguments.length?void 0:arguments[0],m):a},m.yScale=function(){return arguments.length?(c=0>=arguments.length?void 0:arguments[0],m):c},m.value=function(){return arguments.length?(e=o(0>=arguments.length?void 0:arguments[0]),m):e},m.label=function(){return arguments.length?(g=o(0>=arguments.length?void 0:arguments[0]),m):g},m.decorate=function(){return arguments.length?(j=0>=arguments.length?void 0:arguments[0],m):j},m.orient=function(){return arguments.length?(k=0>=arguments.length?void 0:arguments[0],m):k},f.rebind(m,l,"context"),m},r=function(){var a=b.scaleIdentity(),c=[10],d=null,e=function(){var b;return null==d?a.ticks?(b=a).ticks.apply(b,i(c)):a.domain():d};return e.scale=function(){return arguments.length?(a=0>=arguments.length?void 0:arguments[0],e):a},e.ticks=function(){for(var a=arguments.length,b=Array(a),d=0;d<a;d++)b[d]=arguments[d];return c=b,e},e.tickArguments=function(){return arguments.length?(c=0>=arguments.length?void 0:arguments[0],e):c},e.tickValues=function(){return arguments.length?(d=0>=arguments.length?void 0:arguments[0],e):d},e},s=function(a){return a};a.annotationCanvasBand=function(){var a=b.scaleIdentity(),c=b.scaleIdentity(),d="horizontal",g=function(a){return a.from},h=function(a){return a.to},j=function(){},k=e.shapeBar().horizontalAlign("right").verticalAlign("top"),l=function(b){if("horizontal"!==d&&"vertical"!==d)throw new Error("Invalid orientation");var e=k.context(),f="horizontal"===d,i=f?a:c,l=f?c:a,m=i.range(),n=m[1]-m[0],o=f?"x":"y",p=f?"y":"x",q=f?"height":"width",r=f?"width":"height";b.forEach(function(a,b){e.save(),e.beginPath(),e.strokeStyle="transparent",k[p](l(g(a))),k[o](m[0]),k[r](n),k[q](l(h(a))-l(g(a))),j(e,a,b),k.context(e)([a],b),e.fill(),e.stroke(),e.closePath(),e.restore()})};return l.xScale=function(){return arguments.length?(a=0>=arguments.length?void 0:arguments[0],l):a},l.yScale=function(){return arguments.length?(c=0>=arguments.length?void 0:arguments[0],l):c},l.orient=function(){return arguments.length?(d=0>=arguments.length?void 0:arguments[0],l):d},l.decorate=function(){return arguments.length?(j=0>=arguments.length?void 0:arguments[0],l):j},l.fromValue=function(){return arguments.length?(g=o(0>=arguments.length?void 0:arguments[0]),l):g},l.toValue=function(){return arguments.length?(h=o(0>=arguments.length?void 0:arguments[0]),l):h},f.rebind(l,k,"context"),l},a.annotationCanvasCrosshair=function(){var a=function(a){return a.x},c=function(a){return a.y},e=b.scaleIdentity(),h=b.scaleIdentity(),i=g.seriesCanvasPoint(),j=q(),k=q().orient("vertical"),l=b.scaleIdentity(),m=b.scaleIdentity(),n=g.seriesCanvasMulti().series([j,k,i]).xScale(l).yScale(m).mapping(function(a){return[a]}),o=function(b){b.forEach(function(b){l.range(e.range()),m.range(h.range()),i.crossValue(a).mainValue(c),j.value(c),k.value(a),n(b)})};o.x=function(){return arguments.length?(a=0>=arguments.length?void 0:arguments[0],o):a},o.y=function(){return arguments.length?(c=0>=arguments.length?void 0:arguments[0],o):c},o.xScale=function(){return arguments.length?(e=0>=arguments.length?void 0:arguments[0],o):e},o.yScale=function(){return arguments.length?(h=0>=arguments.length?void 0:arguments[0],o):h};var p=f.include("label","decorate");return f.rebindAll(o,j,p,f.prefix("y")),f.rebindAll(o,k,p,f.prefix("x")),f.rebind(o,i,"decorate"),f.rebind(o,n,"context"),o},a.annotationCanvasGridline=function(){var a=function(){},b=function(){},c=r(),d=r(),e=h.line(),g=function(){var f=e.context(),g=c.scale(),h=d.scale();c().forEach(function(b,c){f.save(),f.beginPath(),f.strokeStyle="#bbb",f.fillStyle="transparent",a(f,b,c),e.context(f)(h.domain().map(function(a){return[g(b),h(a)]})),f.fill(),f.stroke(),f.closePath(),f.restore()}),d().forEach(function(a,c){f.save(),f.beginPath(),f.strokeStyle="#bbb",f.fillStyle="transparent",b(f,a,c),e.context(f)(g.domain().map(function(b){return[g(b),h(a)]})),f.fill(),f.stroke(),f.closePath(),f.restore()})};return g.yDecorate=function(){return arguments.length?(b=0>=arguments.length?void 0:arguments[0],g):b},g.xDecorate=function(){return arguments.length?(a=0>=arguments.length?void 0:arguments[0],g):a},f.rebindAll(g,c,f.prefix("x")),f.rebindAll(g,d,f.prefix("y")),f.rebind(g,e,"context"),g},a.annotationCanvasLine=q,a.annotationSvgBand=function(){var a=b.scaleIdentity(),f=b.scaleIdentity(),h="horizontal",i=function(a){return a.from},j=function(a){return a.to},k=function(){},l=d.dataJoin("g","annotation-band"),m=e.shapeBar().horizontalAlign("center").verticalAlign("center").x(0).y(0),n=function(b){if(d.isTransition(b)&&l.transition(b),"horizontal"!==h&&"vertical"!==h)throw new Error("Invalid orientation");var e="horizontal"===h,g=e?function(c,a){return"translate(".concat(c,", ").concat(a,")")}:function(c,a){return"translate(".concat(a,", ").concat(c,")")},n=e?a:f,o=e?f:a,p=n.range(),q=p[1]-p[0],r=e?"height":"width",s=e?"width":"height",t=function(){return g((p[1]+p[0])/2,(o(j.apply(void 0,arguments))+o(i.apply(void 0,arguments)))/2)};m[s](q),m[r](function(){return o(j.apply(void 0,arguments))-o(i.apply(void 0,arguments))}),b.each(function(a,b,d){var e=l(c.select(d[b]),a);e.enter().attr("transform",t).append("path").classed("band",!0),e.attr("class","annotation-band ".concat(h)).attr("transform",t).select("path").attr("d",function(a,b){return m([a],b)}),k(e,a,b)})};return n.xScale=function(){return arguments.length?(a=0>=arguments.length?void 0:arguments[0],n):a},n.yScale=function(){return arguments.length?(f=0>=arguments.length?void 0:arguments[0],n):f},n.orient=function(){return arguments.length?(h=0>=arguments.length?void 0:arguments[0],n):h},n.decorate=function(){return arguments.length?(k=0>=arguments.length?void 0:arguments[0],n):k},n.fromValue=function(){return arguments.length?(i=o(0>=arguments.length?void 0:arguments[0]),n):i},n.toValue=function(){return arguments.length?(j=o(0>=arguments.length?void 0:arguments[0]),n):j},n},a.annotationSvgCrosshair=function(){var a=function(a){return a.x},e=function(a){return a.y},h=b.scaleIdentity(),i=b.scaleIdentity(),j=function(){},k=d.dataJoin("g","annotation-crosshair"),l=g.seriesSvgPoint(),m=p(),n=p().orient("vertical"),o=b.scaleIdentity(),q=b.scaleIdentity(),r=g.seriesSvgMulti().series([m,n,l]).xScale(o).yScale(q).mapping(function(a){return[a]}),s=function(b){d.isTransition(b)&&k.transition(b),b.each(function(b,d,f){var p=k(c.select(f[d]),b);p.enter().style("pointer-events","none"),o.range(h.range()),q.range(i.range()),l.crossValue(a).mainValue(e),m.value(e),n.value(a),p.call(r),j(p,b,d)})};s.x=function(){return arguments.length?(a=0>=arguments.length?void 0:arguments[0],s):a},s.y=function(){return arguments.length?(e=0>=arguments.length?void 0:arguments[0],s):e},s.xScale=function(){return arguments.length?(h=0>=arguments.length?void 0:arguments[0],s):h},s.yScale=function(){return arguments.length?(i=0>=arguments.length?void 0:arguments[0],s):i},s.decorate=function(){return arguments.length?(j=0>=arguments.length?void 0:arguments[0],s):j};var t=f.include("label");return f.rebindAll(s,m,t,f.prefix("y")),f.rebindAll(s,n,t,f.prefix("x")),s},a.annotationSvgGridline=function(){var a=function(){},b=function(){},e=r(),g=r(),h=d.dataJoin("line","gridline-y").key(s),i=d.dataJoin("line","gridline-x").key(s),j=function(f){d.isTransition(f)&&(h.transition(f),i.transition(f)),f.each(function(d,f,j){var k=j[f],l=c.select(j[f]),m=e.scale(),n=g.scale(),o=k.__x_scale__||m;k.__x_scale__=m.copy();var p=e(),q=h(l,p);q.enter().attr("x1",o).attr("x2",o).attr("y1",n.range()[0]).attr("y2",n.range()[1]).attr("stroke","#bbb"),q.attr("x1",m).attr("x2",m).attr("y1",n.range()[0]).attr("y2",n.range()[1]),q.exit().attr("x1",m).attr("x2",m),a(q,p,f);var r=k.__y_scale__||n;k.__y_scale__=n.copy();var s=g(),t=i(l,s);t.enter().attr("y1",r).attr("y2",r).attr("x1",m.range()[0]).attr("x2",m.range()[1]).attr("stroke","#bbb"),t.attr("y1",n).attr("y2",n).attr("x1",m.range()[0]).attr("x2",m.range()[1]),t.exit().attr("y1",n).attr("y2",n),b(t,s,f)})};return j.yDecorate=function(){return arguments.length?(b=0>=arguments.length?void 0:arguments[0],j):b},j.xDecorate=function(){return arguments.length?(a=0>=arguments.length?void 0:arguments[0],j):a},f.rebindAll(j,h,f.includeMap({key:"xKey"})),f.rebindAll(j,i,f.includeMap({key:"yKey"})),f.rebindAll(j,e,f.prefix("x")),f.rebindAll(j,g,f.prefix("y")),j},a.annotationSvgLine=p,Object.defineProperty(a,"__esModule",{value:!0})});
